<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Main Page</title>
  <link rel="stylesheet" href="../css/mainPage.css">
  <link rel="stylesheet" href="../css/master.css">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
  <script>
    n = new Date();
    window.onload = function () {
      changeDate(0);
    };

    function changeDate(val) {
      n.setDate(n.getDate() + val);

      var day = n.getDay();
      var diff = n.getDate() - day + (day == 0 ? -6 : 1);
      var nLimit = new Date();
      var url_string = document.getElementById("calendarFrame").src
      var url = new URL(url_string);
      var mode = url.searchParams.get("mode");
      var period = url.searchParams.get("period");

      n.setDate(diff);
      nLimit.setDate(diff + 6);

      y = n.getFullYear();
      m = n.getMonth() + 1;
      d = n.getDate();

      if (val == 0) {
        mode = "calendar";
        period = "week";
      }

      document.getElementById("date").innerHTML = d + "." + m + "." + y + "\n - " + nLimit.getDate() + "." + (nLimit
        .getMonth() + 1) + "." + nLimit.getFullYear();
      document.getElementById("calendarFrame").src = "../data/calendar.xml?mode=" + mode + "&period=" + period +
        "&date=" + d + "." + m + "." + y;
    }

    function changeCalendarMode(val) {
      var url_string = document.getElementById("calendarFrame").src
      var url = new URL(url_string);
      var mode = url.searchParams.get("mode");
      var date = url.searchParams.get("date");

      document.getElementById("calendarFrame").src = "../data/calendar.xml?mode=" + mode + "&period=" + val + "&date=" +
        date;
    }

    function changeDisplayMode() {
      var url_string = document.getElementById("calendarFrame").src
      var url = new URL(url_string);
      var period = url.searchParams.get("period");
      var date = url.searchParams.get("date");

      if (document.getElementById("displayModeCheckbox").checked) {
        document.getElementById("calendarFrame").src = "../data/calendar.xml?mode=project&period=" + period + "&date=" +
          date;
      } else {
        document.getElementById("calendarFrame").src = "../data/calendar.xml?mode=project&period=" + period + "&date=" +
          date;
      }
    }

    function setVisibilityTrue() {
      document.getElementById("dropdown-content").style.display = "block";
    }
  </script>
</head>

<body>
  <div class="logo">
    <img src="../ressources/plannet_logo_lightblue.png" alt="Logo plannet_logo_lightblue">
  </div>
  <div class="viewToggle">

    <p><pre>Kalenderansicht </pre></p>
    <label class="switch">
      <input type="checkbox" id="displayModeCheckbox" onclick="changeDisplayMode()">
      <span class=" slider round"></span>
    </label>
    <p><pre> Projektansicht</pre></p>
  </div>

  <div class="timeToggle">
    <p>Zeitraum:</p>
    <input type="radio" class="stv-radio-button" id="day" name="timeframeSelect" value="day"
      onClick="changeCalendarMode('day')" checked />
    <label for="day">D</label>
    <input type="radio" class="stv-radio-button" id="week" name="timeframeSelect" value="week"
      onClick="changeCalendarMode('week')" />
    <label for="week">W</label>
    <input type="radio" class="stv-radio-button" id="month" name="timeframeSelect" value="month"
      onClick="changeCalendarMode('month')" />
    <label for="month">M</label>
  </div>

  <input type="image" src="../ressources/user.png" class="userIcon"></input>
  <form class="" action="login.html">
    <input type="image" src="../ressources/logout.png" class="logoutIcon"></input>
  </form>

  <!--muss noch korrekt aus der HTML geladen werden-->
  <div class="dropdown">
    <button class="dropbtn" onclick="setVisibilityTrue()">Meine Kalender &#9660;</button>
    <div class="dropdown-content" id="dropdown-content">
      <div>
        <input type="checkbox" id="calendar1" name="calendar1" value="work">
        <label for="calendar1">Arbeit</label>
      </div>
      <div>
        <input type="checkbox" id="calendar2" name="calendar2" value="private">
        <label for="calendar2">Privat</label>
      </div>
      <div>
        <input type="checkbox" id="calendar3" name="calendar3" value="dhbw">
        <label for="calendar3">DHBW</label>
      </div>
      <!--
      <div class="dropdown-entry">
        <p>Arbeit</p>

        <input type="checkbox">
      </div>
      -->
    </div>
  </div>

  <form class="search" action="mainPage.html" method="post">
    <p>Andere Kalender</p>
    <input type="search" name="Suche" placeholder="Suche">
  </form>

  <div class="add">
    <br>
    <a id="adding" href="createEntry.html" target="popup"
      onclick="window.open('createEntry.html','popup','width=400,height=600', 'resizable=no'); return false;">Hinzuf√ºgen</a>
    <br>
  </div>
  <button class="goback" onClick="changeDate(-7)">&loarr;</button>
  <div id="date">
  </div>
  <button class="goForward" onClick="changeDate(7)">&roarr;</button>
  <iframe class="calendarView" id="calendarFrame" name="calendarFrame" src="../data/calendar.xml"
    frameBorder="0"></iframe>
  <iframe class="footer" src="../html/footer.html" frameBorder="0"></iframe>
</body>

</html>